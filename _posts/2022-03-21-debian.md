---
layout       : post
title        : "Debian安装配置指南"
subtitle     : "Back again"
date         : 2022-03-21 11:14:00
author       : "Manford Fan"
catalog      : false
header-img   : "img/post-bg-universe.jpg"
tags         :
               - OS
               - Tools
---

时隔3年，又回到了Debian的怀抱，不知不觉距上次折腾Debian已经这么长时间了。这次也是心血来潮，小艺那边正好有个笔记本闲置了，就拿来做办公本。因为晚上工作的时候比较多，用台式机要一直笔直的坐着，很累，有个这个小笔记本，我就可以舒服的躺在床上搬砖了。硬件环境是2017年的Lenovo IdeaPad 710S 13ISK超薄本，虽然已经使用了5年了，性能感觉还是很棒，4G内存，256G的NVMe SSD，Intel i7 6500u的CPU，不跑很大的应用程序，Linux本来也不是很吃内存，整体妥妥的~

由于安装过程比较简单，网络上的指导教程也比较多，这里就不在占用篇幅记录。如下主要记录了在使用过程中遇到的问题，日常使用的软件安装配置以及系统配置等

## 一、系统配置类

#### 1、允许root用户登录桌面

```bash
# 第一步，通过普通账户登录root账户
su
Password: 
# 第二步，修改gdm3的设定文件(/etc/gdm3/daemon.conf)，在[security]字段后面追加如下一行：
AllowRoot = true
# 第三步，修改gdm3的登录pam文件(/etc/pam.d/gdm-password)，将如下行注释掉(#) 
auth required pam_succeed_if.so user != root quiet_success
```

#### 2、安装网卡驱动

超薄本没有物理电口网卡，安装好之后因为缺少无线网卡驱动，也无法上网，需要安装好驱动之后才能连接WiFi，根据安装过程中的提示信息，找到官网的驱动安装包[下载地址](https://packages.debian.org/bullseye/firmware-iwlwifi)，下载并安装**firmware-iwlwifi_20210315-3_all.deb**即可。

#### 3、更换软件源

除了阿里，国内还有中科大，清华，网易163以及腾讯源软件仓可以选择~

```bash
cp /etc/apt/sources.list /etc/apt/sources.list.bak

# 将如下行覆盖/etc/apt/sources.list中所有的内容
deb https://mirrors.aliyun.com/debian/ bullseye main non-free contrib
deb-src https://mirrors.aliyun.com/debian/ bullseye main non-free contrib
deb https://mirrors.aliyun.com/debian-security/ bullseye-security main
deb-src https://mirrors.aliyun.com/debian-security/ bullseye-security main
deb https://mirrors.aliyun.com/debian/ bullseye-updates main non-free contrib
deb-src https://mirrors.aliyun.com/debian/ bullseye-updates main non-free contrib
deb https://mirrors.aliyun.com/debian/ bullseye-backports main non-free contrib
deb-src https://mirrors.aliyun.com/debian/ bullseye-backports main non-free contrib

apt update
apt upgrade
```


#### 4、修改时区

原生的系统安装的时候一般都是断开网络的，因为连接网络安装会使用国外的源站下载更新，速度非常的慢导致安装失败，离线安装成功之后时区默认是UTC时区，需要修改成中国标准时区(China Standard Time)。

```bash
# 使用如下命令获取当前时区的代码
timedatectl list-timezones
# 使用如下命令设置时间系统为当前时区
timedatectl set-timezone Asia/Shanghai
```

#### 5、命令自动补全

Linux命令以及参数非常的多，使用自动补全功能会事半功倍，只要记住命令的开头部分的拼写，bash-completion就会帮助我们补全剩下的部分。

```bash
apt install bash-completion
# 在系统配置/etc/profile或者个人配置~/.bashrc中，配置如下
if [ -f /etc/bash_completion ]; then
  . /etc/bash_completion
fi

source /etc/profile
source ~/.bashrc
```

#### 6、中文输入法

对国人来讲，使用Linux作为主力机的障碍之一是中文输入法。执行完如下命令后，在dash中输入`im-config`选择fcitx；再在dash中输入`fcitx-configure`，选择右下角的"+"号，输入搜索想要使用的输入法添加，然后重启系统即可。

```bash
apt-get install locales
dpkg-reconfigure locales # 选择en_US.UTF-8 UTF-8，zh_CN.UTF-8 UTF-8
apt-get install fcitx fcitx-sunpinyin fcitx-table-all fcitx-frontend-all
apt-get install fcitx-ui-classic fcitx-ui-light fcitx-config-gtk
```

> 默认切换输入法的快捷键是 Ctrl \+ Space

#### 7、允许非root用户使用root权限

修改/etc/sudoers文件，在改文件中添加如下最后一行，并执行强制保存退出`:wq!`即可。

```bash
# User privilege specification
root	ALL=(ALL:ALL) ALL
manford ALL=(ALL:ALL) ALL  # 添加此行，其中manford是root用户
```

## 二、软件配置类
 
#### 1、安装坚果云

由于坚果云安装需要各种依赖，依赖包在bullseye的源中并没有，所以需要手动安装，具体方法就是，每报一个依赖就去前一个版本的操作系统所对应的软件仓中下载下来，进行手动安装，迭代3-5步基本能解决问题，如果还不能解决，就可以考虑放弃了。

```bash
dpkg -i libindicator3-7_0.5.0-3+b1_amd64.deb
dpkg -i libappindicator3-1_0.4.92-4_amd64.deb
dpkg -i gir1.2-appindicator3-0.1_0.4.92-4_amd64.deb
apt install gvfs-bin
dpkg -i nautilus_nutstore_amd64.deb
```

#### 2、安装VIM

`vim`的安装非常简单，可以通过`apt install vim`来完成，主要是配置工作，使用之前做好的包，一键自动部署，可选择是简易版的还是高级版的~

#### 3、安装GIT

使用`apt install git`来安装版本控制工具，和`vim`类似，也主要是配置工作。将生成的公钥放在[github](https://github.com/settings/keys)上，然后在本地设置git用户信息，最后就可以愉快的使用git了。

```bash
ssh-keygen -t rsa -C "mffan****@163.com"  # 生成密钥对，放在"~/.ssh/"目录下
git config --global user.name "XXX"
git config --global user.email "XXX@XXX"
cat config  # 这个文件也需要放在.ssh/下面
Host github.com
  HostName github.com
  User mffan0922
  IdentityFile ~/.ssh/Github
  AddKeysToAgent yes
  PreferredAuthentications publickey
  Port 22
```

> 需要将".ssh/"下的文件权限修改成600，否则会有问题

#### 4、安装gnome tweak tool

使用`apt install gnome-tweak-tool`来安装该软件，tweak tool可以辅助设定UI界面，比如字体，墙纸，以及主题等等，非常方便。

- 更换主题
- 安装gnome插件
- 

#### 5、安装微信

https://www.opendesktop.org/s/Gnome/browse/

#### 6、安装openVPN

由于工作需要使用VPN登录专用的网络，Windows下可以使用OpenVPN GUI客户端来登录，Linux下只能使用命令行，不过命令行也有命令行的好处，不再需要像Windows那样使用手机获取token，然后再登录，Linux可以很容易的通过一个脚本命令实现连接。

```bash
apt install openvpn oathtool
oathtool -b --totp 'keyID'
openvpn --config your_ovpn_file
username:
password:
```

> keyID可以通过[线上解析二维码工具](https://jiema.wwei.cn/)获取，一定不可以分享给别人

#### 7、PT站下载工具

作为一个有资源的PTer，及时在Linux下也要充分利用呀。Windows下有官方推荐的uTorrent，Linux下PT下载工具虽然很多，但是能正常工作的目前只发现了qBitTorrent这一款。感觉应该是跟设置有关系，一定要**关闭DHT功能**，否则有被封号的危险。可以使用`apt install qbittorrent`，命令安装，关闭DHT后就可以愉快的下载了。

#### 8、安装VMware


#### 9、安装WPS文档处理软件



#### 、其他应用

```bash
apt install vlc 
```

## 三、参考链接

- https://www.debian.org/distrib/packages
- https://sspai.com/post/64624
- https://blog.csdn.net/Hacker_MAI/article/details/123152952