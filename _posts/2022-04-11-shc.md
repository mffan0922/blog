---
layout       : post
title        : "SHellè„šæœ¬åŠ å¯†"
subtitle     : "Open source? That depends..."
date         : 2022-04-11 20:57:40
author       : "Manford Fan"
catalog      : false
header-img   : "img/post-bg-universe.jpg"
tags         :
               - Shell
               - Encryption
---

æœ‰äººè¯´Shellæ—¶æœ€ç®€å•çš„ç¼–ç¨‹è¯­è¨€ä¹‹ä¸€ï¼Œæˆ‘è®¤ä¸ºè¿™é‡Œæœ‰ä¸ªé¢„è®¾ï¼Œé‚£å°±æ˜¯å¯¹Linuxæ“ä½œç³»ç»Ÿæœ‰ä¸€å®šçš„è®¤è¯†ã€‚å¦‚æœè¯´Linuxæ˜¯ä¸€å—ä¸Šå¥½çš„æœ¨æï¼Œæˆ‘æ„¿ç§°Shellä¸ºé›•åˆ»è¿™å—æœ¨æå¿…å¤‡çš„åˆ©åˆƒï¼Œå®ƒå‡ ä¹å’Œæ˜¯æ“ä½œç³»ç»Ÿèä¸ºä¸€ä½“çš„ã€‚è™½ç„¶Shellæ˜¯ä¸€ç§è§£é‡Šå‹è¯­è¨€ï¼Œæ‰§è¡Œé€Ÿåº¦ç›¸å¯¹äºCï¼ŒC++ç­‰è¿™äº›ç¼–è¯‘å‹è¯­è¨€æ…¢å¾ˆå¤šï¼Œæ›´ä¸ç”¨ææ±‡ç¼–ï¼›ä¹Ÿæ²¡æœ‰ç²¾å·§çš„æ•°æ®ç»“æ„ï¼Œæ— æ³•å®Œæˆå¤æ‚ç®—æ³•çš„å®ç°ï¼Œè€Œä¸”ç¨‹åºç¨å¾®ä¸€é•¿ï¼Œå°±è®©äººå¾ˆå®¹æ˜“è¿·æƒ‘ã€‚å°½ç®¡Shellæœ‰å¾ˆå¤šç¼ºç‚¹ï¼Œä½†æ˜¯æ¯ä¸€ç§è¯­è¨€éƒ½æœ‰å…¶é€‚ç”¨çš„é¢†åŸŸï¼Œ[ABS](https://tldp.org/LDP/abs/html/index.html)ä¸­è¯¦ç»†çš„é˜è¿°äº†ä»€ä¹ˆæ—¶å€™ä¸é€‚åˆç”¨Shellï¼Œä»¥åŠä»€ä¹ˆæ—¶å€™é€‚åˆã€‚Shellçš„è¯­æ³•ç®€å•ï¼Œè°ƒè¯•å®¹æ˜“ï¼ˆéœ€è¦æŒæ¡æŠ€å·§ï¼‰ï¼Œèƒ½å¾ˆå¿«çš„å®ç°è¾ƒä¸ºç®€å•ï¼ˆç¨å¾®å¤æ‚çš„ä¹Ÿå¯ä»¥ï¼‰çš„ä»»åŠ¡ã€‚

ç”±äºShellæ˜¯ä¸€ç§è§£é‡Šå‹è¯­è¨€ï¼Œè¿™ä¸ªç‰¹æ€§å°±æ³¨å®šå®ƒçš„æºç æ˜¯å…¬å¼€çš„ï¼Œå¯æ˜¯æœ‰æ—¶å€™æˆ‘ä»¬ç¼–å†™çš„è„šæœ¬ä¸­åŒ…å«ä¸€äº›å¯†ç ï¼Œç»™åˆ«äººç”¨çš„åŒæ—¶ä¸æƒ³é€éœ²ç»™åˆ«äººå…¶ä¸­çš„ç§å¯†ä¿¡æ¯ã€‚è¿™ä¸ªæ—¶å€™å°±éœ€è¦å¯¹Shellè„šæœ¬è¿›è¡ŒåŠ å¯†ã€‚[SHC](http://www.datsi.fi.upm.es/~frosal/sources/)å·¥å…·èƒ½å¾ˆå¥½åœ°å®Œæˆè¿™ä¸€åŠ å¯†å·¥ä½œï¼Œå®ƒæ˜¯ç”±è¥¿ç­ç‰™çš„Francisco Javier Rosales GarcÃ­aå…ˆç”Ÿç¼–å†™çš„ï¼Œèƒ½æ»¡è¶³ç»å¤§å¤šæ•°ä½¿ç”¨åœºæ™¯ï¼Œä½†æ˜¯æ­£å¦‚åœ¨å·¥å…·ç®€ä»‹ä¸­ä¸æ­¢ä¸€æ¬¡çš„è¯´ï¼Œ"Use with care"ï¼Œ"CHECK YOUR RESULTS CAREFULLY BEFORE USING"ï¼Œè€Œä¸”ä¹Ÿç»™å‡ºäº†åˆ°ç›®å‰ä¸ºæ­¢å‘ç°çš„ä¸€ä¸ªbugã€‚æ‰€ä»¥æœ€å¥½åªæ˜¯ç”¨äºç§äººç¯å¢ƒï¼Œç”Ÿäº§ç¯å¢ƒè¿˜æ˜¯è¦è°¨æ…ä½¿ç”¨ã€‚

## 1. ç¼–è¯‘å®‰è£…SHC

`shc`å·¥å…·çš„åŸç†æ˜¯ï¼Œè®²Shellè„šæœ¬è§£é‡Šç§°Cè¯­è¨€æºç ï¼Œç„¶åé€šè¿‡ç¼–è¯‘Cè¯­è¨€æºç å¾—åˆ°äºŒè¿›åˆ¶æ–‡ä»¶ã€‚åŠ å¯†å®Œæˆåç”Ÿæˆäº†ä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªæ˜¯.xæ–‡ä»¶ï¼Œæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ï¼Œåç§°å¯ä»¥ä»»æ„ä¿®æ”¹ï¼Œå¦ä¸€ä¸ªæ˜¯.x.cæ–‡ä»¶ï¼Œæ˜¯Cè¯­è¨€çš„æºç æ–‡ä»¶ï¼Œå¯ä»¥åˆ é™¤ã€‚ç¼–è¯‘è¿‡ç¨‹å¦‚ä¸‹ï¼Œ`make`ä¹‹åç›®å½•ä¸‹ä¼šæœ‰ä¸€ä¸ª`shc`å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ‰§è¡Œ`./shc -h`å³å¯çœ‹åˆ°å¸®åŠ©ä¿¡æ¯ã€‚

```bash
wget http://www.datsi.fi.upm.es/~frosal/sources/shc-3.8.9b.tgz
tar -xzf shc-3.8.9b.tgz
cd shc-3.8.9b
make
```

----

é€šè¿‡ç¼–è¯‘å®éªŒå‘ç°æºç å®‰è£…çš„å¯æ‰§è¡Œæ–‡ä»¶åŠ å¯†Shellè„šæœ¬åä¸èƒ½å¾—åˆ°æ­£ç¡®çš„è¾“å‡ºï¼Œæœ€åå¶ç„¶å‘ç°å¯ä»¥é€šè¿‡è½¯ä»¶åŒ…ç®¡ç†å·¥å…·ç›´æ¥å®‰è£…â€”â€”`apt/yum install shc`ï¼ŒğŸ™ƒğŸ™ƒï¼Œè¡Œå§ã€‚

## 2. SHCç”¨æ³•ä»‹ç»

> #### â‘  è¯­æ³•è§„èŒƒ

```bash
shc [ -e date ] [ -m addr ] [ -i iopt ] [ -x cmnd ] [ -l lopt ] [ -o outfile ] [ -ABCDhUv ] -f script
```

> #### â‘¡ å‘½ä»¤é€‰é¡¹

|é€‰é¡¹|åŠŸèƒ½|
|:-|:-|
|-e <ins>date</ins>|æŒ‡å®šè¿‡æœŸæ—¶é—´ï¼Œæ ¼å¼æ˜¯**dd/mm/yyyy**|
|-m <ins>message</ins>|å½“è¿‡æœŸæ—¶å±•ç¤ºçš„æ¶ˆæ¯æç¤ºï¼Œé»˜è®¤æ˜¯"Please contact your provider"|
|-f <ins>script file</ins>|è¦åŠ å¯†çš„è„šæœ¬æ–‡ä»¶|
|-i <ins>inline option</ins>|shellç¼–è¯‘å™¨æŒ‡å®šçš„å†…è”é€‰é¡¹|
|-x <ins>command</ins>|eXec command, as a printf format i.e: exec(\\'%s\\',@ARGV);|
|-l <ins>last option</ins>|Last shell option i.e: --|
|-o <ins>outfile</ins>|æŒ‡å®šè¾“å‡ºæ–‡ä»¶å|
|-r|ä½¿ç”¨å®½æ¾çš„å®‰å…¨ç­–ç•¥ï¼Œç”Ÿæˆä¸€ä¸ªå¯é‡æ–°åˆ†å‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œåœ¨ä¸åŒçš„ç³»ç»Ÿä¸Šè¿è¡Œ|
|-v|æ˜¾ç¤ºè¯¦ç»†çš„ç¼–è¯‘è¿‡ç¨‹|
|-D|Switch on debug exec calls|
|-U|Make binary to be untraceable (using strace, ptrace, truss, etc.)|
|-B|Compile for BusyBox|

## 3. ç¤ºä¾‹å±•ç¤º

```bash
[ 0 root@aliyun ~]# cat > test.sh << EOF
> #!/bin/bash
> passcode='123457asdf'
> echo -n \$passcode | md5sum | awk '{print \$1}'
> EOF
[ 0 root@aliyun ~]# bash test.sh
7c2dd6ea4593cea88b2a4dae1a581e1b
[ 0 root@aliyun ~]# shc -r -U -f test.sh -o gen_md5
[ 0 root@aliyun ~]# ls
gen_md5  test.sh  test.sh.x.c 
[ 0 root@aliyun ~]# ./gen_md5
7c2dd6ea4593cea88b2a4dae1a581e1b
```
